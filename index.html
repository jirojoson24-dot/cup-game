<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine Surprise</title>

<style>
html, body {
  margin: 0;
  height: 100%;
  background: #ffe6f0;
  font-family: "Comic Sans MS", cursive;
}

/* GAME CONTAINER */
#game {
  width: 360px;
  margin: auto;
  background: #ffe6f0;
  padding: 15px;
  border-radius: 20px;
  text-align: center;
}

h1 { color: #ff1493; }
#round { color: #c2185b; }

#stage {
  position: relative;
  height: 180px;
  margin-top: 20px;
}

.cup {
  width: 90px;
  height: 120px;
  background: #ff69b4;
  border-radius: 0 0 30px 30px;
  position: absolute;
  bottom: 0;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.ball {
  position: absolute;
  bottom: -18px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 26px;
  display: none;
}

#freeBall {
  font-size: 30px;
  display: none;
}

#message {
  min-height: 40px;
  color: #ad1457;
  margin-top: 10px;
}

/* FINAL VIDEO SCREEN */
#finalScreen {
  position: fixed;
  inset: 0;
  background: #ffe6f0;
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-align: center;
  padding: 10px;
}

#finalScreen h2 {
  color: #ff1493;
  margin-bottom: 5px;
}

#finalScreen p {
  color: #c2185b;
  margin-bottom: 15px;
}

video {
  width: 100%;
  max-width: 90vw;
  max-height: 70vh;
  object-fit: contain;
  border-radius: 15px;
}
</style>
</head>

<body>

<div id="game">
  <h1>ðŸ¥¤ Find the Ball ðŸ¥¤</h1>
  <div id="round">Round 1 of 5</div>

  <div id="freeBall">âšª</div>

  <div id="stage">
    <div class="cup" style="transform:translateX(0px)">
      <div class="ball">âšª</div>
    </div>
    <div class="cup" style="transform:translateX(135px)">
      <div class="ball">âšª</div>
    </div>
    <div class="cup" style="transform:translateX(270px)">
      <div class="ball">âšª</div>
    </div>
  </div>

  <div id="message">Watch closely ðŸ‘€</div>
</div>

<div id="finalScreen">
  <h2>Will you be my Valentine?</h2>
  <p>
    Renz Lloyd Peji Consumo,<br>
    tirador ng kwekwek
  </p>
  <video id="finalVideo" playsinline>
    <source src="final.mp4" type="video/mp4">
  </video>
</div>

<script>
const cups = [...document.querySelectorAll(".cup")];
const balls = document.querySelectorAll(".ball");
const freeBall = document.getElementById("freeBall");
const message = document.getElementById("message");
const roundText = document.getElementById("round");
const game = document.getElementById("game");
const finalScreen = document.getElementById("finalScreen");
const finalVideo = document.getElementById("finalVideo");

let positions = [0, 135, 270];
let round = 1;
let winningIndex = 0;
let canPick = false;

function startRound() {
  canPick = false;
  balls.forEach(b => b.style.display = "none");
  message.textContent = "Look at the ball ðŸ‘€";

  freeBall.style.display = "block";
  winningIndex = Math.floor(Math.random() * 3);

  setTimeout(() => {
    freeBall.style.display = "none";
    cups[winningIndex].querySelector(".ball").style.display = "block";

    setTimeout(() => {
      balls.forEach(b => b.style.display = "none");
      shuffle();
    }, 600);
  }, 1000);
}

function shuffle() {
  message.textContent = "Shuffling...";

  let swaps = 6 + round * 3;
  let intervalTime = Math.max(120, 350 - round * 45);
  let transitionTime = Math.max(0.18, 0.35 - round * 0.03);

  cups.forEach(c => c.style.transition = `transform ${transitionTime}s ease`);

  let interval = setInterval(() => {
    let i = Math.floor(Math.random() * 3);
    let j = Math.floor(Math.random() * 3);
    if (i === j) return;

    [positions[i], positions[j]] = [positions[j], positions[i]];
    cups[i].style.transform = `translateX(${positions[i]}px)`;
    cups[j].style.transform = `translateX(${positions[j]}px)`;

    if (winningIndex === i) winningIndex = j;
    else if (winningIndex === j) winningIndex = i;

    if (--swaps <= 0) {
      clearInterval(interval);
      message.textContent = "Pick a cup ðŸ¥¤";
      canPick = true;
    }
  }, intervalTime);
}

cups.forEach((cup, index) => {
  cup.addEventListener("click", () => {
    if (!canPick) return;

    balls.forEach(b => b.style.display = "none");
    cups[winningIndex].querySelector(".ball").style.display = "block";

    if (index === winningIndex) {
      message.textContent = "Correct!";
      canPick = false;

      setTimeout(() => {
        round++;
        if (round > 5) {
          game.remove();
          finalScreen.style.display = "flex";
          finalVideo.muted = false;
          finalVideo.play();
        } else {
          roundText.textContent = `Round ${round} of 5`;
          startRound();
        }
      }, 900);
    } else {
      message.textContent = "Wrong ðŸ˜ˆ Try again!";
      canPick = false;
      setTimeout(startRound, 900);
    }
  });
});

startRound();
</script>

</body>
</html>
